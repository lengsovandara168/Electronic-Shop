---
import Layout from '@/layouts/Layout.astro';
import ProductDetail from '@/components/ProductDetail.tsx';

export async function getStaticPaths() {
  // Pre-build detail pages for all DummyJSON products to increase coverage
  const res = await fetch('https://dummyjson.com/products?limit=500');
  const json = res.ok ? await res.json() : { products: [] };
  const allItems: any[] = Array.isArray(json.products) ? json.products : [];
  const normalize = (s: string) => s.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/(^-|-$)+/g, '');
  return allItems.map((it: any) => ({
    params: { id: `phn-${normalize(String(it.title ?? ''))}-${normalize(String(it.brand ?? ''))}-${it.id}` },
  }));
}

const { id } = Astro.params;
const pageTitle = `Tri-god â€¢ ${id}`;
---
<Layout title={pageTitle}>
  <ProductDetail client:load />
</Layout>
